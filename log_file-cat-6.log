Logger initialized. Log level: INFO, log file: ./log_file-cat-6.log
Started
Starting experiment: "lstm-predict-cat-6": "lstm-predict-cat-6"
Wiping and initializing checkpoint save location models/0_current_model_checkpoints
Creating model save location models/lstm-predict-cat-6
Creating new Neptune experiment
Neptune run URL: https://app.neptune.ai/sjsivertandsanderkk/Masteroppgave/e/MAS-312
Running complete with parameters in specified in config. Experiment with saving set to True
Choosing model structure: <src.model_strutures.local_univariate_lstm_structure.LocalUnivariateLstmStructure object at 0x14e3ee07bb80>
Running model on device: cuda
Initializing LSTM with 3 layers, 268 hidden size, 0.0003 learning rate, 0.113 dropout. Optimiser: AdaDelta,  input window size: 5, output window size: 1
Using pre-existing neptune run for PytorchLightning
data preprocessing steps: 
 ---- Start ----
1- load market insight data and categories and merge them
2- convert date columns to date_time format
3- sum up clicks to category level [groupBy(date, cat_id)]
4- rename column 'title' to 'cat_name'
5- combine feature 'hits' and 'clicks' to new feature 'interest'
6- drop columns 'hits' and 'clicks'
7- filter out data from early 2018-12-01
8- drop uninteresting colums: ['id_x', 'manufacturer_id', '_version_', 'id_y', 'internal_doc_id_x', 'internal_doc_id_y']
---- End ----
        

------------------
Starting new timer at 12:37:58
Data Pipeline for 6: ---- Start ----
1- Convert input dataset to generator object
2- filter out category 6)
3- choose columns 'interest' and 'date'
4- fill in dates with zero values
5- convert to np.array
6- scale data between -1 and 1
7- split up into training set (0.9) and test set (0.09999999999999998)
8- split training set into train set (0.9) and validation set (0.09999999999999998)
9- convert to timeseries dataset with input window size of 5, and output window size of 1
---- End ----
        
Converting dataset to dataloader using batch size 219.
Ending timer at: 12:37:58 
Elapsed CPU time: 0.22300533333350359s
Used real time: 0:00:00
------------------
Training model
Testing model
Testing error: {'MASE': 1.0544606447219849, 'SMAPE': 0.1348693072795868, 'MSE': 0.009350793436169624, 'MAE': 0.07645487785339355}.
Saving model
Error occurred during asynchronous operation processing: Cannot upload file /cluster/home/sjsivert/Masteroppgave/log_file.log: Path not found or is a not a file.
Finished
